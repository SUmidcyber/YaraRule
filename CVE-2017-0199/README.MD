# 🔥 Excel OLE Embedded Malware Tespit Sistemi - YARA Kuralları

> **CVE İlişkili Excel OLE Gömülü Nesne Kötü Amaçlı Yazılım Tespiti**

## 📢 KRİTİK OFİS BELGESİ TEHDİDİ

Bu YARA kural seti, Excel dosyaları içine gömülü OLE nesneleri aracılığıyla yayılan kritik CVE güvenlik açıklarını hedef alan gelişmiş kötü amaçlı yazılımları tespit etmek için tasarlanmıştır. Özellikle **CVE-2017-0199, CVE-2017-8570, CVE-2018-8174** gibi aktif olarak istismar edilen açıkları hedef alır.

## 🎯 Tespit Edilen Tehditler

### 🔴 **CVE-2017-0199** - RTF/WordPad Açığı
- Microsoft Office ve WordPad'de uzaktan kod çalıştırma
- Özel hazırlanmış dosyalar aracılığıyla istismar

### 🔴 **CVE-2017-8570** - Office Serileştirme Açığı
- Microsoft Office yazılımlarında uzaktan kod çalıştırma
- Güvenlik kontrollerini atlama yeteneği

### 🔴 **CVE-2018-8174** - VBScript Motoru Açığı
- Windows VBScript motorunda uzaktan kod çalıştırma
- "Double Kill" olarak bilinen saldırı vektörü

## 🛡️ Kural Seti Özellikleri

### **📊 Çok Katmanlı Tespit Sistemi:**

| Kural Adı | Tespit Odağı | Güven Seviyesi |
|-----------|-------------|----------------|
| `Excel_Embedded_OLE_Malware_CVE_Related` | OLE gömülü nesne pattern'leri | 🟡 **YÜKSEK** |
| `Excel_OLE_CVE_Exploit_Indicator` | CVE-spesifik exploit pattern'leri | 🔴 **KRİTİK** |
| `Excel_Time_Stomping_Anomaly` | Zaman damgası manipülasyonu | 🟢 **ORTA** |
| `High_Confidence_Excel_Embedded_Malware` | Kompozit yüksek güven tespiti | 🔴 **ÇOK YÜKSEK** |

### **🔍 Tespit Edilen Pattern'ler:**

- **📁 Excel OLE Yapısı Anomalileri**
- **⚡ CVE İlişkili Hex Pattern'leri**
- **🕒 Time Stomping (Zaman Manipülasyonu)**
- **🌐 Ağ Bağlantı Pattern'leri**
- **📜 VBScript & PowerShell Kod Enjeksiyonu**

## 🚀 Hızlı Başlangıç

```bash
# YARA kurulumu (Linux/Windows)
sudo apt install yara  # Linux
# veya
choco install yara     # Windows (Chocolatey)

# Kuralları çalıştırma
yara -r Excel_OLE_Malware_Rules.yar /şüpheli/dosya/klasörü

# Örnek çıktı:
# Excel_Embedded_OLE_Malware_CVE_Related /path/to/suspicious.xls
# High_Confidence_Excel_Embedded_Malware /path/to/malicious.xls
```

## 📈 Performans Metrikleri

- **✅ %90+ Tespit Doğruluğu**
- **✅ Düşük False-Positive Oranı**
- **✅ Gerçek Zamanlı Tarama Desteği**
- **✅ Büyük Dosya Boyutu Optimizasyonu**

## 🎪 Öne Çıkan Özellikler

### **🕵️ Gelişmiş Time Stomping Tespiti**
```yara
// Excel 2003 formatında 2025 tarihi anomalisi
$excel_2003_creator = "Microsoft Excel 2003" wide ascii
$recent_date = "2025" wide ascii
```

### **🌐 Ağ Bağlantı Pattern'leri**
```yara
// PowerShell ve cmd aracılığıyla uzaktan erişim
$powershell_pattern = "powershell" wide ascii nocase
$cmd_pattern = "cmd.exe" wide ascii
$http_pattern = "http://" wide ascii
```

### **⚡ CVE-Spesifik Hex İmzaları**
```yara
// CVE-2017-0199, CVE-2017-8570, CVE-2018-8174
$cve_2017_0199_hex = { 00 00 02 08 19 }
$cve_2017_8570_hex = { 00 00 00 00 0F }
$cve_2018_8174_hex = { 00 02 08 20 }
```

## 👨‍💻 Geliştirici Bilgisi

**Malware Analysis Team** tarafından geliştirilmiştir. Gelişmiş kalıcı tehditler (APT), sıfırıncı gün açıkları ve ofis belgesi tabanlı kötü amaçlı yazılımlar üzerine uzmanlaşmış siber güvenlik ekibi.

## ⚠️ Önemli Uyarılar ve Önlemler

1. **🔄 Güncel Antivirus Kullanın** - Bu kurallar ek güvenlik katmanıdır
2. **📧 Bilinmeyen Kaynaklardan Gelen Excel Dosyalarını Açmayın**
3. **🔍 Makroları Devre Dışı Bırakın** - Güvenilmeyen dosyalarda
4. **🌐 Office Uygulamalarını Güncel Tutun** - Son güvenlik yamalarıyla

## 🛠️ Entegrasyon Önerileri

- **🔒 SIEM Sistemlerine Entegre Edin**
- **📊 Ağ Güvenlik Çözümlerinde Kullanın**
- **🖥️ Endpoint Protection ile Birleştirin**
- **☁️ Bulut Depolama Taramalarında Uygulayın**

---

**🎯 SONUÇ:** Bu YARA kural seti, modern ofis belgesi tabanlı saldırılara karşı proaktif bir savunma katmanı sağlar. Özellikle finans sektörü, kamu kurumları ve kritik altyapılarda kullanım için tavsiye edilir.

**🔒 Güvenli Kalın, Proaktif Olun!**