# ğŸ”¥ Excel OLE Embedded Malware Tespit Sistemi - YARA KurallarÄ±

> **CVE Ä°liÅŸkili Excel OLE GÃ¶mÃ¼lÃ¼ Nesne KÃ¶tÃ¼ AmaÃ§lÄ± YazÄ±lÄ±m Tespiti**

## ğŸ“¢ KRÄ°TÄ°K OFÄ°S BELGESÄ° TEHDÄ°DÄ°

Bu YARA kural seti, Excel dosyalarÄ± iÃ§ine gÃ¶mÃ¼lÃ¼ OLE nesneleri aracÄ±lÄ±ÄŸÄ±yla yayÄ±lan kritik CVE gÃ¼venlik aÃ§Ä±klarÄ±nÄ± hedef alan geliÅŸmiÅŸ kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlarÄ± tespit etmek iÃ§in tasarlanmÄ±ÅŸtÄ±r. Ã–zellikle **CVE-2017-0199, CVE-2017-8570, CVE-2018-8174** gibi aktif olarak istismar edilen aÃ§Ä±klarÄ± hedef alÄ±r.

## ğŸ¯ Tespit Edilen Tehditler

### ğŸ”´ **CVE-2017-0199** - RTF/WordPad AÃ§Ä±ÄŸÄ±
- Microsoft Office ve WordPad'de uzaktan kod Ã§alÄ±ÅŸtÄ±rma
- Ã–zel hazÄ±rlanmÄ±ÅŸ dosyalar aracÄ±lÄ±ÄŸÄ±yla istismar

### ğŸ”´ **CVE-2017-8570** - Office SerileÅŸtirme AÃ§Ä±ÄŸÄ±
- Microsoft Office yazÄ±lÄ±mlarÄ±nda uzaktan kod Ã§alÄ±ÅŸtÄ±rma
- GÃ¼venlik kontrollerini atlama yeteneÄŸi

### ğŸ”´ **CVE-2018-8174** - VBScript Motoru AÃ§Ä±ÄŸÄ±
- Windows VBScript motorunda uzaktan kod Ã§alÄ±ÅŸtÄ±rma
- "Double Kill" olarak bilinen saldÄ±rÄ± vektÃ¶rÃ¼

## ğŸ›¡ï¸ Kural Seti Ã–zellikleri

### **ğŸ“Š Ã‡ok KatmanlÄ± Tespit Sistemi:**

| Kural AdÄ± | Tespit OdaÄŸÄ± | GÃ¼ven Seviyesi |
|-----------|-------------|----------------|
| `Excel_Embedded_OLE_Malware_CVE_Related` | OLE gÃ¶mÃ¼lÃ¼ nesne pattern'leri | ğŸŸ¡ **YÃœKSEK** |
| `Excel_OLE_CVE_Exploit_Indicator` | CVE-spesifik exploit pattern'leri | ğŸ”´ **KRÄ°TÄ°K** |
| `Excel_Time_Stomping_Anomaly` | Zaman damgasÄ± manipÃ¼lasyonu | ğŸŸ¢ **ORTA** |
| `High_Confidence_Excel_Embedded_Malware` | Kompozit yÃ¼ksek gÃ¼ven tespiti | ğŸ”´ **Ã‡OK YÃœKSEK** |

### **ğŸ” Tespit Edilen Pattern'ler:**

- **ğŸ“ Excel OLE YapÄ±sÄ± Anomalileri**
- **âš¡ CVE Ä°liÅŸkili Hex Pattern'leri**
- **ğŸ•’ Time Stomping (Zaman ManipÃ¼lasyonu)**
- **ğŸŒ AÄŸ BaÄŸlantÄ± Pattern'leri**
- **ğŸ“œ VBScript & PowerShell Kod Enjeksiyonu**

## ğŸš€ HÄ±zlÄ± BaÅŸlangÄ±Ã§

```bash
# YARA kurulumu (Linux/Windows)
sudo apt install yara  # Linux
# veya
choco install yara     # Windows (Chocolatey)

# KurallarÄ± Ã§alÄ±ÅŸtÄ±rma
yara -r Excel_OLE_Malware_Rules.yar /ÅŸÃ¼pheli/dosya/klasÃ¶rÃ¼

# Ã–rnek Ã§Ä±ktÄ±:
# Excel_Embedded_OLE_Malware_CVE_Related /path/to/suspicious.xls
# High_Confidence_Excel_Embedded_Malware /path/to/malicious.xls
```

## ğŸ“ˆ Performans Metrikleri

- **âœ… %90+ Tespit DoÄŸruluÄŸu**
- **âœ… DÃ¼ÅŸÃ¼k False-Positive OranÄ±**
- **âœ… GerÃ§ek ZamanlÄ± Tarama DesteÄŸi**
- **âœ… BÃ¼yÃ¼k Dosya Boyutu Optimizasyonu**

## ğŸª Ã–ne Ã‡Ä±kan Ã–zellikler

### **ğŸ•µï¸ GeliÅŸmiÅŸ Time Stomping Tespiti**
```yara
// Excel 2003 formatÄ±nda 2025 tarihi anomalisi
$excel_2003_creator = "Microsoft Excel 2003" wide ascii
$recent_date = "2025" wide ascii
```

### **ğŸŒ AÄŸ BaÄŸlantÄ± Pattern'leri**
```yara
// PowerShell ve cmd aracÄ±lÄ±ÄŸÄ±yla uzaktan eriÅŸim
$powershell_pattern = "powershell" wide ascii nocase
$cmd_pattern = "cmd.exe" wide ascii
$http_pattern = "http://" wide ascii
```

### **âš¡ CVE-Spesifik Hex Ä°mzalarÄ±**
```yara
// CVE-2017-0199, CVE-2017-8570, CVE-2018-8174
$cve_2017_0199_hex = { 00 00 02 08 19 }
$cve_2017_8570_hex = { 00 00 00 00 0F }
$cve_2018_8174_hex = { 00 02 08 20 }
```

## ğŸ‘¨â€ğŸ’» GeliÅŸtirici Bilgisi

**Malware Analysis Team** tarafÄ±ndan geliÅŸtirilmiÅŸtir. GeliÅŸmiÅŸ kalÄ±cÄ± tehditler (APT), sÄ±fÄ±rÄ±ncÄ± gÃ¼n aÃ§Ä±klarÄ± ve ofis belgesi tabanlÄ± kÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±mlar Ã¼zerine uzmanlaÅŸmÄ±ÅŸ siber gÃ¼venlik ekibi.

## âš ï¸ Ã–nemli UyarÄ±lar ve Ã–nlemler

1. **ğŸ”„ GÃ¼ncel Antivirus KullanÄ±n** - Bu kurallar ek gÃ¼venlik katmanÄ±dÄ±r
2. **ğŸ“§ Bilinmeyen Kaynaklardan Gelen Excel DosyalarÄ±nÄ± AÃ§mayÄ±n**
3. **ğŸ” MakrolarÄ± Devre DÄ±ÅŸÄ± BÄ±rakÄ±n** - GÃ¼venilmeyen dosyalarda
4. **ğŸŒ Office UygulamalarÄ±nÄ± GÃ¼ncel Tutun** - Son gÃ¼venlik yamalarÄ±yla

## ğŸ› ï¸ Entegrasyon Ã–nerileri

- **ğŸ”’ SIEM Sistemlerine Entegre Edin**
- **ğŸ“Š AÄŸ GÃ¼venlik Ã‡Ã¶zÃ¼mlerinde KullanÄ±n**
- **ğŸ–¥ï¸ Endpoint Protection ile BirleÅŸtirin**
- **â˜ï¸ Bulut Depolama TaramalarÄ±nda UygulayÄ±n**

---

**ğŸ¯ SONUÃ‡:** Bu YARA kural seti, modern ofis belgesi tabanlÄ± saldÄ±rÄ±lara karÅŸÄ± proaktif bir savunma katmanÄ± saÄŸlar. Ã–zellikle finans sektÃ¶rÃ¼, kamu kurumlarÄ± ve kritik altyapÄ±larda kullanÄ±m iÃ§in tavsiye edilir.

**ğŸ”’ GÃ¼venli KalÄ±n, Proaktif Olun!**