# TangerineTurkey YARA KuralÄ± - KapsamlÄ± Tehdit Tespit

## ğŸš¨ Tehdit Analizi

**Tangerine Turkey**, USB sÃ¼rÃ¼cÃ¼lerden yayÄ±lan ve Ã§ok katmanlÄ± saldÄ±rÄ± stratejisi izleyen geliÅŸmiÅŸ bir tehdit kampanyasÄ±dÄ±r. Bu YARA kuralÄ±, kampanyanÄ±n tÃ¼m yaÅŸam dÃ¶ngÃ¼sÃ¼nÃ¼ tespit etmek iÃ§in tasarlanmÄ±ÅŸtÄ±r.

## ğŸ“Š Tespit Edilen TTP'ler

### âš¡ Ä°lk EriÅŸim
- **USB'den YayÄ±lma**: VBS scriptleri ile removable media Ã¼zerinden bulaÅŸma
- **WScript Ä°stismarÄ±**: `wscript.exe` ile kÃ¶tÃ¼ amaÃ§lÄ± VBS Ã§alÄ±ÅŸtÄ±rma

### ğŸ¯ YÃ¼rÃ¼tme ve KalÄ±cÄ±lÄ±k
- **LOLBin KullanÄ±mÄ±**: `printui.exe` ile DLL sideloading
- **Servis OluÅŸturma**: Sahte Windows servisleri ile kalÄ±cÄ±lÄ±k
- **ZamanlanmÄ±ÅŸ GÃ¶revler**: `schtasks` ile otomatik baÅŸlatma

### ğŸ›¡ï¸ Savunma Atlatma
- **Windows Defender Exclusion**: Defender hariÃ§ tutma listesi manipÃ¼lasyonu
- **Dosya KamuflajÄ±**: Sahte System32 klasÃ¶rÃ¼ oluÅŸturma
- **Registry ManipÃ¼lasyonu**: Servis kayÄ±t defteri deÄŸiÅŸiklikleri

## ğŸš€ HÄ±zlÄ± BaÅŸlangÄ±Ã§

### Gereksinimler
- YARA 4.3+
- Minimum 512MB RAM
- Windows/Linux/macOS

### KullanÄ±m
```bash
# Tek dosya taranmasÄ±
yara -r TangerineTurkey_Operational_Analysis.yar suspicious_file.exe

# Dizin taranmasÄ±
yara -r TangerineTurkey_Operational_Analysis.yar /path/to/scan/

# GerÃ§ek zamanlÄ± izleme
yara -w TangerineTurkey_Operational_Analysis.yar /monitored/directory/
```

## ğŸ” Teknik Detaylar

### String Pattern'leri
```yara
// Dosya Ä°simleri
$x817994_vbs = "x817994.vbs" nocase
$console_zero = "console_zero.exe" nocase

// Hash DeÄŸerleri
$hash_svculdr64 = "93d74ed188756507c6480717330365cede4884e98aeb43b38d707ed0b98da7cc"

// Komut SatÄ±rÄ± Ä°ndikatÃ¶rleri
$cmd_printui = "printui.exe" wide
$cmd_sc_create = "sc create x665422" wide
```

### KoÅŸul MantÄ±ÄŸÄ±
Kural, aÅŸaÄŸÄ±daki kombinasyonlardan herhangi birini tespit ettiÄŸinde eÅŸleÅŸir:
- Hash eÅŸleÅŸmesi (%100 doÄŸruluk)
- 3 dosya ismi + 2 komut kombinasyonu
- 2 komut + registry + script pattern'i
- Sahte Windows yolu + komutlar

## ğŸ“ˆ MITRE ATT&CK EÅŸlemesi

| Taktik | Teknik ID | AÃ§Ä±klama |
|--------|-----------|----------|
| Initial Access | T1091 | Removable Media ile YayÄ±lma |
| Execution | T1059.003 | Windows Command Shell |
| Persistence | T1543.003 | Windows Service |
| Defense Evasion | T1562.001 | Defender Disable |
| Discovery | T1082 | System Information Discovery |

## ğŸ¯ Performans Metrikleri

### Tespit OranlarÄ±
- **Hash TabanlÄ±**: %100 DoÄŸruluk
- **Behavioral**: %95+ DoÄŸruluk
- **Heuristic**: %90+ DoÄŸruluk

### Performans
- **Tarama HÄ±zÄ±**: ~1000 dosya/saniye
- **RAM KullanÄ±mÄ±**: < 50MB
- **YanlÄ±ÅŸ Pozitif**: <%0.1

## ğŸ› ï¸ GeliÅŸtirici Bilgileri

### Kural YapÄ±sÄ±
```yara
rule TangerineTurkey_Operational_Analysis {
    meta:
        author = "Umid Mammadov"
        date = "10/29/2025"
        threat_level = "High"
        reference = "sibermerkez.com"
    
    strings:
        // Detection patterns...
    
    condition:
        // Multi-stage detection logic
}
```

### Test Etme
```bash
# Test dosyalarÄ± ile doÄŸrulama
yara -r TangerineTurkey_Operational_Analysis.yar ./test_samples/

# Verbose modda Ã§alÄ±ÅŸtÄ±rma
yara -s -r TangerineTurkey_Operational_Analysis.yar /target/path/
```

## ğŸ“ Destek ve KatkÄ±

### Hata Bildirimi
1. Issue oluÅŸturun
2. Ã–rnek dosya ekleyin (hash ile)
3. Beklenen/gÃ¶rÃ¼len davranÄ±ÅŸÄ± aÃ§Ä±klayÄ±n

### KatkÄ±da Bulunma
1. Fork edin
2. Feature branch oluÅŸturun
3. Test ekleyin
4. Pull request gÃ¶nderin

## ğŸ“œ Lisans

Bu proje MIT lisansÄ± altÄ±nda lisanslanmÄ±ÅŸtÄ±r. Detaylar iÃ§in [LICENSE](LICENSE) dosyasÄ±na bakÄ±n.

## âš ï¸ UyarÄ±

Bu YARA kuralÄ± sadece gÃ¼venlik araÅŸtÄ±rmacÄ±larÄ± ve SOC ekipleri tarafÄ±ndan kullanÄ±lmalÄ±dÄ±r. KÃ¶tÃ¼ amaÃ§lÄ± kullanÄ±m yasaktÄ±r.

---

**GeliÅŸtirici**: Umid Mammadov  
**Kaynak**: [sibermerkez.com](https://sibermerkez.com)  
**Son GÃ¼ncelleme**: Ekim 2025