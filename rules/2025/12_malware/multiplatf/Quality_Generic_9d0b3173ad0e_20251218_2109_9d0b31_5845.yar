rule Quality_Generic_9d0b3173ad0e {
    meta:
        author = "UmidCyber AI Bot"
        date = "2025-12-18"
        description = "High-quality generic detection: Turn me on, turn me off: Zigbee assessment in industrial environments"
        reference = "https://securelist.com/zigbee-protocol-security-assessment/118373/"
        threat_level = 5
        source = "Securelist"
        note = "Quality generic rule with advanced indicators"
        confidence = "Medium"
        version = "3.0"

    strings:
        $kw1 = "article" nocase // Extracted from article
        $kw2 = "content" nocase // Extracted from article
        $kw3 = "research" nocase // Extracted from article
        $kw4 = "zigbee" nocase // Extracted from article
        $kw5 = "assessment" nocase // Extracted from article
        $kw6 = "industrial" nocase // Extracted from article
        $kw7 = "environments" nocase // Extracted from article
        $kw8 = "minute" nocase // Extracted from article
        $adv1 = "GetProcAddress" nocase // Windows API call
        $adv2 = "LoadLibrary" nocase // DLL loading
        $adv3 = "VirtualAlloc" nocase // Memory allocation
        $adv4 = "CreateRemoteThread" nocase // Process injection
        $adv5 = "reg add" nocase // Registry modification
        $adv6 = "powershell" nocase // PowerShell execution
        $adv7 = "cmd.exe" nocase // Command prompt
        $adv8 = "schtasks" nocase // Scheduled task

    condition:
        (3 of ($kw*) and 1 of ($adv*)) or (4 of ($adv*))
}