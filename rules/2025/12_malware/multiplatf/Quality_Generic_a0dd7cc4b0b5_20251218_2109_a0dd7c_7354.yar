rule Quality_Generic_a0dd7cc4b0b5 {
    meta:
        author = "UmidCyber AI Bot"
        date = "2025-12-18"
        description = "High-quality generic detection: Following the digital trail: what happens to data stolen in a phishing"
        reference = "https://securelist.com/what-happens-to-stolen-data-after-phishing-attacks/118180/"
        threat_level = 5
        source = "Securelist"
        note = "Quality generic rule with advanced indicators"
        confidence = "Medium"
        version = "3.0"

    strings:
        $kw1 = "article" nocase // Extracted from article
        $kw2 = "content" nocase // Extracted from article
        $kw3 = "research" nocase // Extracted from article
        $kw4 = "following" nocase // Extracted from article
        $kw5 = "trail" nocase // Extracted from article
        $kw6 = "happens" nocase // Extracted from article
        $kw7 = "stolen" nocase // Extracted from article
        $kw8 = "phishing" nocase // Extracted from article
        $adv1 = "GetProcAddress" nocase // Windows API call
        $adv2 = "LoadLibrary" nocase // DLL loading
        $adv3 = "VirtualAlloc" nocase // Memory allocation
        $adv4 = "CreateRemoteThread" nocase // Process injection
        $adv5 = "reg add" nocase // Registry modification
        $adv6 = "powershell" nocase // PowerShell execution
        $adv7 = "cmd.exe" nocase // Command prompt
        $adv8 = "schtasks" nocase // Scheduled task

    condition:
        (3 of ($kw*) and 1 of ($adv*)) or (4 of ($adv*))
}